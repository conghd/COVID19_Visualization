
<html>

<head>
    <style>
    </style>
</head>

<body>
    <svg id="container" height="600" width="600">
        <g id="body" transform="translate(150,150)"></g>
        
    </svg>
</body>
<script src="d3.js"></script>
<script>
    const DEBUG = true;
    function log(message) {
        if (DEBUG)
        console.log(message);
    }
    let body = d3.select("#body")

    Promise.all([
        d3.csv("data.csv"),
        d3.json("countries.geo.json")

    ]).then(showData)

    function showData(datasources) {
        let data = datasources[0]
        let mapInfo = datasources[1]

        let bodyHeight = 400
        let bodyWidth = 400

        log(mapInfo)
        log(data)


        let projection = d3.geoMercator()
            .scale(80)
            .translate([bodyWidth/2, bodyHeight/2])

        let path = d3.geoPath()
            .projection(projection)

        body.selectAll("path").data(mapInfo.features)
            .enter().append("path")
            .attr("d", d => path(d))
            .attr("stroke", "#aaa")
            .attr("fill", "#eee")

        body.selectAll("circle")
            .data(data)
            .enter()
            .append("circle")
            .attr("r", 3)
            .attr("fill", "#0055AA")
            .attr("opacity", 0.3)
            .attr("cx", d => projection([+d.Longitude, +d.Latitude])[0])
            .attr("cy", d => projection([+d.Longitude, +d.Latitude])[1])
    }

</script>
</html>